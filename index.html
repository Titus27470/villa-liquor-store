<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Wine & Spirits Shop</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #f2f2f2;
            margin: 0;
            padding: 0;
        }

        header {
            background: #4B0082;
            color: #fff;
            padding: 20px;
            text-align: center;
        }

        nav {
            display: flex;
            justify-content: center;
            background: #fff;
            padding: 10px;
        }

            nav button {
                margin: 0 10px;
                padding: 10px 20px;
                cursor: pointer;
                border: none;
                border-radius: 4px;
            }

                nav button:hover {
                    background: #ddd;
                }

        .section {
            display: none;
            padding: 20px;
        }

        .active {
            display: block;
        }

        .products {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
        }

        .item {
            background: #fff;
            border-radius: 8px;
            margin: 10px;
            padding: 15px;
            width: 250px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

            .item img {
                width: 100%;
                height: auto;
                border-radius: 8px;
            }

        button {
            background: #4B0082;
            color: #fff;
            border: none;
            padding: 10px;
            margin-top: 10px;
            border-radius: 4px;
            cursor: pointer;
        }

            button:hover {
                background: #6A0DAD;
            }

        #adminPage, #userPage, #loginPage, #registerPage, #paymentPage {
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            width: 300px;
            margin: 0 auto;
        }

        input {
            width: 100%;
            padding: 8px;
            margin: 8px 0;
        }
    </style>
</head>
<body>

    <header>
        <h1>Wine & Spirits Shop</h1>
    </header>

    <nav>
        <button onclick="showSection('home')">Home</button>
        <button onclick="showSection('products')">Products</button>
        <button onclick="showSection('login')">Login</button>
        <button onclick="showSection('register')">Register</button>
        <button onclick="showSection('admin')">Admin</button>
    </nav>

    <div id="home" class="section active">
        <h2>Welcome to our Wine & Spirits Store</h2>
        <p>Browse our selection and make your purchase.</p>
    </div>

    <div id="products" class="section">
        <h2>Our Products</h2>
        <div class="products" id="productList"></div>
    </div>

    <div id="login" class="section">
        <h2>Login</h2>
        <form onsubmit="login(event)">
            <input type="text" id="loginUser" placeholder="Username" required />
            <input type="password" id="loginPass" placeholder="Password" required />
            <button type="submit">Login</button>
        </form>
    </div>

    <div id="register" class="section">
        <h2>Register</h2>
        <form onsubmit="register(event)">
            <input type="text" id="regUser" placeholder="Username" required />
            <input type="password" id="regPass" placeholder="Password" required />
            <button type="submit">Register</button>
        </form>
    </div>

    <div id="admin" class="section">
        <h2>Admin Panel</h2>
        <p>Enter admin password to access</p>
        <form onsubmit="adminLogin(event)">
            <input type="password" id="adminPass" placeholder="Admin Password" required />
            <button type="submit">Login as Admin</button>
        </form>
        <div id="adminTools" style="display:none; margin-top:20px;">
            <h3>Edit Products</h3>
            <div id="adminProducts"></div>
            <button onclick="logoutAdmin()">Logout Admin</button>
        </div>
    </div>

    <div id="user" class="section">
        <h2>Welcome, <span id="userName"></span></h2>
        <button onclick="showPage('order')">Make an Order</button>
        <button onclick="logout()">Logout</button>
    </div>

    <div id="order" class="section">
        <h2>Select Product</h2>
        <div class="products" id="orderProducts"></div>
        <div id="orderDetails" style="margin-top:20px;"></div>
        <button onclick="backToUser()">Back</button>
    </div>

    <div id="payment" class="section">
        <h2>Payment Mode</h2>
        <div id="paymentOptions"></div>
        <div id="paymentInstructions" style="margin-top:20px;"></div>
        <button onclick="confirmPayment()">I Paid</button>
        <button onclick="cancelPayment()">Cancel</button>
    </div>

    <script>
  // Sample products
  let products = [
    { id:1, name:"Red Wine", description:"Premium red wine", price:20, image:"https://images.unsplash.com/photo-1609284873487-3a5d2e7f7f10", stock:10 },
    { id:2, name:"Whiskey", description:"Aged whiskey", price:50, image:"https://images.unsplash.com/photo-1600960907174-ef7a21e0770d", stock:8 },
    { id:3, name:"Vodka", description:"Pure vodka", price:30, image:"https://images.unsplash.com/photo-1600153485654-4d582d7a4c3b", stock:12 }
  ];

  let currentUser = null;
  let adminLoggedIn = false;
  let selectedProduct = null;
  let currentPage = 'home';

  function showSection(id) {
    document.querySelectorAll('.section').forEach(s => s.style.display='none');
    document.getElementById(id).style.display='block';
    currentPage = id;
    if(id==='home') { /* do nothing */ }
    if(id==='products') { displayProducts(); }
    if(id==='admin') { /* check admin login status */ }
  }

  // Display products
  function displayProducts() {
    const container = document.getElementById('productList');
    container.innerHTML='';
    products.forEach(p => {
      if(p.stock>0) {
        const div = document.createElement('div');
        div.className='item';
        div.innerHTML= `
          <img src="${p.image}" />
          <h3>${p.name}</h3>
          <p>${p.description}</p>
          <p>Price: $${p.price}</p>
          <p>Available: ${p.stock}</p>
          <button onclick="selectProduct(${p.id})">Buy</button>
        `;
        container.appendChild(div);
      }
    });
  }

  // Register
  function register(e) {
    e.preventDefault();
    const user = document.getElementById('regUser').value;
    const pass = document.getElementById('regPass').value;
    if(localStorage.getItem('user_'+user)){
      alert('Username exists');
      return;
    }
    localStorage.setItem('user_'+user, pass);
    alert('Registered! You can login now.');
    showSection('login');
  }

  // Login
  function login(e) {
    e.preventDefault();
    const user = document.getElementById('loginUser').value;
    const pass = document.getElementById('loginPass').value;
    const storedPass = localStorage.getItem('user_'+user);
    if(storedPass && storedPass===pass){
      currentUser = user;
      document.getElementById('userName').innerText = user;
      showSection('user');
    } else { alert('Invalid login'); }
  }

  // Admin login
  function adminLogin(e) {
    e.preventDefault();
    const pass = document.getElementById('adminPass').value;
    if(pass==='Bett6577'){
      adminLoggedIn=true;
      document.getElementById('adminTools').style.display='block';
      showSection('admin');
      loadAdminProducts();
    } else {
      alert('Incorrect password');
    }
  }

  function logoutAdmin() {
    adminLoggedIn=false;
    document.getElementById('adminTools').style.display='none';
    showSection('home');
  }

  function loadAdminProducts() {
    const container = document.getElementById('adminProducts');
    container.innerHTML='';
    products.forEach(p => {
      const div = document.createElement('div');
      div.innerHTML= `
        <h4>${p.name}</h4>
        <label>Price: <input type="number" value="${p.price}" onchange="updatePrice(${p.id}, this.value)"></label>
        <label>Stock: <input type="number" value="${p.stock}" onchange="updateStock(${p.id}, this.value)"></label>
        <button onclick="deleteProduct(${p.id})">Delete</button>
        <hr />
      `;
      container.appendChild(div);
    });
  }

  function updatePrice(id, val) {
    const p=products.find(p=>p.id===id);
    if(p) p.price = parseFloat(val);
  }

  function updateStock(id, val) {
    const p=products.find(p=>p.id===id);
    if(p) p.stock = parseInt(val);
  }

  function deleteProduct(id) {
    products=products.filter(p=>p.id!==id);
    loadAdminProducts();
    displayProducts();
  }

  // User actions
  function showPage(page) {
    showSection(page);
    if(page==='order') {
      displayOrderProducts();
    }
  }

  function displayOrderProducts() {
    const container = document.getElementById('orderProducts');
    container.innerHTML='';
    products.forEach(p => {
      if(p.stock>0){
        const div = document.createElement('div');
        div.className='item';
        div.innerHTML= `
          <img src="${p.image}" />
          <h3>${p.name}</h3>
          <p>${p.description}</p>
          <p>Price: $${p.price}</p>
          <p>Available: ${p.stock}</p>
          <button onclick="selectOrderProduct(${p.id})">Buy</button>
        `;
        container.appendChild(div);
      }
    });
  }

  function selectOrderProduct(id) {
    selectedProduct=products.find(p=>p.id===id);
    if(selectedProduct && selectedProduct.stock>0) {
      showSection('payment');
      document.getElementById('paymentOptions').innerHTML= `
        <p>Select Payment Method:</p>
        <button onclick="setPaymentMode('BTC')">Pay with BTC</button>
        <button onclick="setPaymentMode('USDT')">Pay with USDT</button>
        <button onclick="setPaymentMode('M-PESA')">Pay with M-Pesa</button>
      `;
      document.getElementById('paymentInstructions').innerHTML='';
    }
  }

  let currentPaymentMode='';

  function setPaymentMode(mode) {
    currentPaymentMode=mode;
    let instructions='';
    if(mode==='BTC' || mode==='USDT') {
      instructions= `
        <p>Send $${selectedProduct.price} worth of ${mode} to:</p>
        <p><strong>Address:</strong> bc1qwjnuurwzrfanwtacg2mahumz5nez5kw3rc0uel</p>
        <p>Once sent, click "I Paid".</p>`;
    } else if(mode==='M-PESA') {
      instructions= `
        <p>Send $${selectedProduct.price} via M-Pesa to number: 0714895321</p>
        <p>Enter your PIN after sending.</p>`;
    }
    document.getElementById('paymentInstructions').innerHTML=instructions;
  }

  function confirmPayment() {
    alert('Thank you! Your payment is being processed. Your order will be delivered soon.');
    // Deduct stock
    if(selectedProduct) selectedProduct.stock--;
    showPage('user');
  }

  function cancelPayment() {
    showPage('user');
  }

  function backToUser() {
    showPage('user');
  }

  function logout() {
    currentUser=null;
    showSection('home');
  }

  // Initialize
  function init() {
    showSection('home');
    displayProducts();
  }

  init();
    </script>

</body>
</html>